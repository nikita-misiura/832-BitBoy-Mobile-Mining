# Git Code Delivery 

Проект разработан как внутренний инструмент компании для доставки кода в репозиторий заказчика.
Принцип работы основан на выборе целевого репозитория и ветки, куда необходимо доставить код. Каждый релиз (доставляемы код) доставляется единым коммитом, подписанным с помощью корпоративного пользователя [pixelplex](https://gitlab.pixelplex.by/pixelplex) ([github_account](https://github.com/pixelplex)). Данный пользователь должен иметь доступ как как к репозиторию источнику (откуда доставляем код), так и к целевому репозиторию (куда доставляем код). Ниже приведен список переменных среды окружения, которые можно установить при ручном и автоматическом запуске доставки кода.

  **MANUAL_DELIVERY_CODE_TO_CUSTOMER:**
    "Необходимо установить в true для ручной доставки кода в репозиторий заказчика. По умолчанию: false"

  **AUTO_DELIVERY_CODE_TO_CUSTOMER:** 
    "Необходимо установить в true для автоматической доставки кода в репозиторий заказчика. Срабатывает при коммите в ветку $FROM_BRANCH. По умолчанию: false" 

  **SOURCE_REPOSITORY:** 
    "Ссылка на репозиторий с кодом. По умолчанию: git@${CI_SERVER_HOST}:${CI_PROJECT_PATH}.git Необходима ссылка с доступом по ssh."

  **TARGET_REPOSITORY:** 
    "Ссылка на репозиторий заказчика. Необходима ссылка с доступом по ssh."

  **RELEASE_NAME:** 
    "Название текущего релиза. Подставляется в название переподписанного коммита. По умолчанию: release_<время в формате yyyymmdd>"

  **FROM_BRANCH:**
    "Код из какой ветки будет доставлен в репозиторий заказчика. По умолчанию: master"

  **TO_BRANCH:** 
    "Ветка куда будет доставлен код в репозиторий заказчика. Если не установлено, то значение выбирается из переменной $RELEASE_NAME"

  **DOCKER_AUTH_CONFIG:** 
    "Конфиг для авторизации в приватный docker registry с образом $PRIVATE_REGISTRY_IMAGE"

  **PRIVATE_REGISTRY_IMAGE:** 
    "Образ с в котором прокинуты SSH-ключи и обеспечены доступы к нашему репозиторию/репозиторию заказчика"

